<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=IBM+Plex+Sans:wght@400;600&display=swap" rel="stylesheet" />
  <title>Student Application Form</title>
     <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'IBM Plex Sans', sans-serif;
      background: linear-gradient(to right, #f2f2f2, #e0e0e0);
      color: #343a40;
      line-height: 1.6;
      padding: 20px;
    }

    .container {
      background: #ffffff;
      padding: 40px;
      max-width: 800px;
      margin: 50px auto;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }

    h3 {
      color: #007bff;
      text-align: center;
      margin-bottom: 20px;
    }

    label {
      margin-top: 15px;
      display: block;
      font-weight: bold;
      color: #495057;
    }

    input, select {
      width: 100%;
      padding: 12px;
      margin-top: 5px;
      border: 1px solid #ced4da;
      border-radius: 5px;
      font-size: 16px;
      transition: border-color 0.3s;
    }

    input:focus, select:focus {
      border-color: #007bff;
      outline: none;
    }

    .error-message {
      color: red;
      font-size: 14px;
      text-align: center;
      margin-top: 5px;
      display: none; /* Hidden by default */
    }

    .buttonContainer {
      display: flex;
      justify-content: center;
      margin-top: 30px;
    }

    button {
      padding: 12px 25px;
      background: #007bff;
      color: #ffffff;
      border: none;
      border-radius: 6px;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.3s;
    }

    button:hover {
      background: #0056b3;
    }

    @media (max-width: 600px) {
      .container {
        padding: 20px;
      }
    }

    .message {
      margin: 20px 0;
      line-height: 1.5;
      text-align: justify;
      background: #f8f9fa;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }

    .subText {
      margin: 20px 0;
    }

    .sub {
      font-size: 13px;
      color: #6c757d;
    }
  .error-message { color: red; font-size: 14px; margin-top: 5px; display: none; }
    #loading { display: none; text-align: center; color: #007bff; margin-top: 20px; }
    #successMsg { display: none; text-align: center; color: green; margin-top: 20px; }
  </style>
</head>

<body>

<div class="message">
  <p>Welcome to the online application website of Padre Garcia Polytechnic College (PGPC). This platform is designed to provide a convenient and secure way for incoming students to apply for the upcoming Academic Year 2025–2026.</p>
  <p>Applicants are required to provide accurate and complete information to facilitate the evaluation and processing of their application. All submitted data will be reviewed by the Admission and Testing Office in accordance with institutional policies and admission guidelines.</p>
  <p>PGPC values your privacy and ensures that all personal and sensitive information collected through this platform will be handled in compliance with Republic Act No. 10173, or the Data Privacy Act of 2012, and its Implementing Rules and Regulations (IRR). Your data may only be disclosed to authorized partners or government agencies when legally required or contractually necessary.</p>
</div>

<div class="container">
  <h3>I. STUDENT INFORMATION</h3>
    <form id="applicationForm">
      <!-- Student Program -->
      <label for="studentCourse">Program (Course):</label>
      <select id="studentCourse" name="studentCourse" required>
        <option value="" disabled selected>Select Course</option>
        <option>BS Computer Science</option>
        <option>B Public Administration</option>
        <option>BS Criminology</option>
        <option>BS Management Accountancy</option>
      </select>

      <!-- Name fields -->
      <label for="lastName">Last Name:</label>
      <input type="text" id="lastName" name="lastName" required>

      <label for="firstName">First Name:</label>
      <input type="text" id="firstName" name="firstName" required>

      <label for="middleName">Middle Name:</label>
      <input type="text" id="middleName" name="middleName" required>

      <!-- Date and place of birth -->
      <label for="birthDate">Date of Birth:</label>
      <input type="date" id="birthDate" name="birthDate" required>

      <label for="studentBirthPlace">Place of Birth:</label>
      <input type="text" id="studentBirthPlace" name="studentBirthPlace" required>

      <!-- Sex and status -->
      <label for="studentSex">Sex:</label>
      <select id="studentSex" name="studentSex" required>
        <option value="" disabled selected>Select Sex</option>
        <option>Male</option><option>Female</option>
      </select>

      <label for="civilStatus">Civil Status:</label>
      <select id="civilStatus" name="civilStatus" required>
        <option value="" disabled selected>Select Status</option>
        <option>Single</option><option>Married</option><option>Widower</option>
      </select>

      <label for="studentReligion">Religion:</label>
      <input type="text" id="studentReligion" name="studentReligion" required>

      <label for="studentCitizenship">Citizenship:</label>
      <input type="text" id="studentCitizenship" name="studentCitizenship" required>

      <label for="studentNumber">Mobile No.:</label>
      <input type="text" id="studentNumber" name="studentNumber" placeholder="09171234567" inputmode="numeric" required>
      <div class="error-message" id="mobileError">Please enter a valid 11-digit mobile number.</div>

      <label for="studentEmail">Email Address:</label>
      <input type="email" id="studentEmail" name="studentEmail" required>
      <div class="error-message" id="emailError">Please enter a valid email address.</div>

      <label for="studentAddress">Permanent Address:</label>
      <input type="text" id="studentAddress" name="studentAddress" required>

      <label for="studentPostal">Postal Code:</label>
      <input type="tel" id="studentPostal" name="studentPostal" pattern="[0-9]{4,6}" required>

      <!-- Family Background -->
      <h3>II. FAMILY BACKGROUND</h3>
      <label for="fatherName">Father's Name:</label>
      <input type="text" id="fatherName" name="fatherName" required>

      <label for="fatherOccupation">Occupation:</label>
      <input type="text" id="fatherOccupation" name="fatherOccupation" required>

      <label for="fatherNumber">Contact No./s:</label>
      <input type="tel" id="fatherNumber" name="fatherNumber" pattern="[0-9]{10,15}" required>

      <label for="motherName">Mother's Maiden Name:</label>
      <input type="text" id="motherName" name="motherName" required>

      <label for="motherOccupation">Occupation:</label>
      <input type="text" id="motherOccupation" name="motherOccupation" required>

      <label for="motherNumber">Contact No./s:</label>
      <input type="tel" id="motherNumber" name="motherNumber" pattern="[0-9]{10,15}" required>

      <label for="guardianName">Guardian's Name:</label>
      <input type="text" id="guardianName" name="guardianName" required>

      <label for="guardianOccupation">Guardian's Occupation:</label>
      <input type="text" id="guardianOccupation" name="guardianOccupation" required>

      <label for="guardianNumber">Contact No./s:</label>
      <input type="tel" id="guardianNumber" name="guardianNumber" pattern="[0-9]{10,15}" required>

      <label>Average Family Income:</label>
      <div class="radio-group">
        <label><input type="radio" name="familyIncome" value="below10k" required /> 10,000 and below</label>
        <label><input type="radio" name="familyIncome" value="10kto20k" /> 10,001–20,000</label>
        <label><input type="radio" name="familyIncome" value="20kto30k" /> 20,001–30,000</label>
        <label><input type="radio" name="familyIncome" value="30kto40k" /> 30,001–40,000</label>
        <label><input type="radio" name="familyIncome" value="40kto50k" /> 40,001–50,000</label>
        <label><input type="radio" name="familyIncome" value="50kto100k" /> 50,001–100,000</label>
        <label><input type="radio" name="familyIncome" value="100kAbove" /> 100,001 and above</label>
      </div>

      <!-- Educational Background -->
      <h3>III. EDUCATIONAL BACKGROUND</h3>
      <label for="strand">Senior High School Strand:</label>
      <input type="text" id="strand" name="strand" required>

      <label for="sname">SHS Name:</label>
      <input type="text" id="sname" name="sname" required>

      <label for="saddress">Address:</label>
      <input type="text" id="saddress" name="saddress" required>

      <label>School Year:</label>
      <div style="display:flex;gap:10px;">
        <input type="number" id="startDate" name="startDate" min="1900" max="2099" required>
        <span>–</span>
        <input type="number" id="endDate" name="endDate" min="1900" max="2099" required>
      </div>

      <label for="college">College (if any) / ALS Graduate:</label>
      <input type="text" id="college" name="college">
      <label for="cname">School Name:</label>
      <input type="text" id="cname" name="cname">
      <label for="caddress">Address:</label>
      <input type="text" id="caddress" name="caddress">
      <label>School Year:</label>
      <div style="display:flex;gap:10px;">
        <input type="number" id="cstartDate" name="cstartDate" min="1900" max="2099">
        <span>–</span>
        <input type="number" id="cendDate" name="cendDate" min="1900" max="2099">
      </div>
      <label for="cprogram">Program:</label>
      <input type="text" id="cprogram" name="cprogram">

      <label>Member of Cultural Minority Group?</label>
      <div class="radio-group">
        <label><input type="radio" name="member" value="yes" required /> Yes</label>
        <label><input type="radio" name="member" value="no" /> No</label>
      </div>

      <label>Do you have any physical disability or condition?</label>
      <div class="radio-group">
        <label><input type="radio" name="special" value="yes" required /> Yes</label>
        <label><input type="radio" name="special" value="no" /> No</label>
      </div>

      <div class="buttonContainer">
        <button type="submit">Next</button>
      </div>

      <div id="loading">Saving...</div>
      <div id="successMsg">✅ Saved! Redirecting...</div>
    </form>
  </div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

 <script>
  const firebaseConfig = {
    apiKey: "AIzaSyB9oTiiW5iXfiDgcyrEktTBkEh1ZFmZ7Pc",
    authDomain: "flipbook-a5350.firebaseapp.com",
    projectId: "flipbook-a5350",
    storageBucket: "flipbook-a5350.appspot.com",
    messagingSenderId: "570378601966",
    appId: "1:570378601966:web:96ebb77badba7e33107aff"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  async function saveData(event) {
    event.preventDefault();

    // Reset errors
    document.getElementById("mobileError").style.display = "none";
    document.getElementById("emailError").style.display = "none";

    const mobileNumber = document.getElementById("studentNumber").value.trim();
    const email = document.getElementById("studentEmail").value.trim();

    // Basic validation
    if (!/^\d{11}$/.test(mobileNumber)) {
      document.getElementById("mobileError").style.display = "block";
      return;
    }
    if (!/^\S+@\S+\.\S+$/.test(email)) {
      document.getElementById("emailError").style.display = "block";
      return;
    }

    const form = document.getElementById("applicationForm");
    const data = new FormData(form);
    const obj = {};
    data.forEach((v, k) => { obj[k] = v; });

    // Capture unchecked radio values
    obj.familyIncome = form.querySelector('input[name="familyIncome"]:checked')?.value || "";
    obj.member       = form.querySelector('input[name="member"]:checked')?.value || "";
    obj.special      = form.querySelector('input[name="special"]:checked')?.value || "";

    // Add timestamp & UID if available
    obj.submittedAt = firebase.firestore.FieldValue.serverTimestamp();

    try {
      document.getElementById("loading").style.display = "block";
      await db.collection("applications").add(obj);
      document.getElementById("loading").style.display = "none";
      document.getElementById("successMsg").style.display = "block";

      // Optional: mark in studentApplications
      const uid = firebase.auth()?.currentUser?.uid;
      if (uid) {
        db.collection("studentApplications").doc(uid).update({
          formSubmitted: true,
          updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        }).catch(() => {});
      }

      setTimeout(() => {
        window.location.href = "Consent.html";
      }, 2000);
    } catch (err) {
      document.getElementById("loading").style.display = "none";
      alert("Error saving data. Please try again.");
      console.error(err);
    }
  }

  // ✅ Attach the event listener to the form
  document.addEventListener("DOMContentLoaded", () => {
    document.getElementById("applicationForm").addEventListener("submit", saveData);
  });
</script>
</body>
</html>