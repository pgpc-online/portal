<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Consent and Review of Information</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      margin: 0;
      padding: 30px;
    }

    .container {
      background: white;
      padding: 30px;
      border-radius: 8px;
      max-width: 800px;
      margin: auto;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    h2 {
      text-align: center;
      color: #007bff;
    }

    .data-preview {
      margin: 20px 0;
      line-height: 1.6;
      white-space: pre-wrap;
      background: #fafafa;
      padding: 20px;
      border-radius: 6px;
      font-size: 14px;
    }

    button {
      display: block;
      width: 100%;
      padding: 12px;
      background-color: #007bff;
      color: white;
      font-size: 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    button:hover {
      background-color: #0056b3;
    }

    .message {
      margin-top: 20px;
      text-align: center;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Consent & Final Submission</h2>
    <p>I am fully aware that Padre Garcia Polytechnic College is obligated under the Data Privacy Act of 2012 and its Implementing Rules and Regulations (IRR) effective since September 8, 2016, to protect all my personal and sensitive information that it collects, processes, and retains upon my application for admission, enrolment and during my stay in the College. Likewise, I am fully aware that PGPC may share such information to affiliated or partner organizations as part of its contractual obligations, or with government agencies pursuant to law or legal processes. In this regard, I hereby allow PGPC to collect, process, use and share my personal data in the pursuit of its legitimate academic, research and employment purposes and/or interests as an educational institution.</p>

    <div class="data-preview" id="previewArea">
      Loading data...
    </div>
<p>I hereby certify that all information supplied in this application form is complete and accurate. I also understand that any false information will disqualify me from being admitted to the College.</p>

    <button onclick="submitToFirebase()">Confirm & Submit</button>

    <div class="message" id="statusMessage"></div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

  <script>
    // üîß Your Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyB9oTiiW5iXfiDgcyrEktTBkEh1ZFmZ7Pc",
      authDomain: "flipbook-a5350.firebaseapp.com",
      databaseURL: "https://flipbook-a5350-default-rtdb.firebaseio.com",
      projectId: "flipbook-a5350",
      storageBucket: "flipbook-a5350.appspot.com",
      messagingSenderId: "570378601966",
      appId: "1:570378601966:web:96ebb77badba7e33107aff",
      measurementId: "G-LCKP7BY0L7"
    };
      

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const previewArea = document.getElementById("previewArea");

    // Get and display all form data from localStorage
    const formData = {};
    for (let i = 0; i < localStorage.length; i++) {
      const key = localStorage.key(i);
      const value = localStorage.getItem(key);
      formData[key] = value;
    }

    // Display preview
    previewArea.textContent = Object.entries(formData)
      .map(([key, value]) => `${key}: ${value}`)
      .join("\n");

    function submitToFirebase() {
      const statusMsg = document.getElementById("statusMessage");

      const fullName = formData.firstName + "_" + formData.lastName;

      db.ref("applications/" + fullName).set(formData)
        .then(() => {
          statusMsg.textContent = "‚úÖ Application successfully submitted!";
          statusMsg.style.color = "green";
          localStorage.clear();
        })
        .catch((error) => {
          statusMsg.textContent = "‚ùå Error submitting: " + error.message;
          statusMsg.style.color = "red";
        });
    }
  </script>
</body>
</html>